
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\03_Advanced\plot_02_extract_data.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_03_Advanced_plot_02_extract_data.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_03_Advanced_plot_02_extract_data.py:


.. _plot_02_extract_data:

==========================
Extract Individual Spectra
==========================

This example demonstrates how to extract data from a multidimensional sldata object. For example, extracting a single spectrum (or a set of spectra) for a 2D set of spectra.

.. GENERATED FROM PYTHON SOURCE LINES 13-16

Load 2D NMR Data
----------------
For this example we will use a two-dimensional ODNP-enhanced NMR data set. Start by importing and plotting the 2D NMR data set created in the previous example (:ref:`plot_01_align_nmr_spectra`).

.. GENERATED FROM PYTHON SOURCE LINES 16-25

.. code-block:: Python


    import spinlab as sl

    file_name_path = "../../data/h5/PowerBuildUpAligned.h5"
    data = sl.load(file_name_path)
    data.attrs["experiment_type"] = "nmr_spectrum"
    sl.fancy_plot(data, xlim=[-10, 20], title="ODNP, 10 mM TEMPO in Toluene")
    sl.plt.show()




.. image-sg:: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_001.png
   :alt: ODNP, 10 mM TEMPO in Toluene
   :srcset: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 26-27

The example data set consists of ODND-enhanced NMR spectra of a sample of 10 mM TEMPO in toluene. In the second dimension the microwave power is varied.

.. GENERATED FROM PYTHON SOURCE LINES 29-32

Indexing Using Integers
-----------------------
Let's start with the simplest way to extract (index) a single spectrum from a 2D NMR data set. The data set imported here are ODNP-enhanced 1H NMR spectra of toluene. One dimension contains the NMR spectrum (``dim = 'f2'``) and the microwave power is increased throughout the second dimension (``dim = 'power'``). To extract data from the sldata object, the user has to specify the name of the dimension and the index of the spectrum. This index has to be an integer and follows the Python convention for indexing (0 is the first index, -1 is the last index). For example, the 4th NMR spectrum at a given microwave power can be extracted from the 2D data set by:

.. GENERATED FROM PYTHON SOURCE LINES 32-35

.. code-block:: Python


    single_spectrum = data["Power", 3]








.. GENERATED FROM PYTHON SOURCE LINES 36-37

Next, we can plot the spectrum (Note, that the spectrum is not referenced correctly).

.. GENERATED FROM PYTHON SOURCE LINES 37-41

.. code-block:: Python


    sl.fancy_plot(single_spectrum, xlim=[-10, 20])
    sl.plt.show()




.. image-sg:: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_002.png
   :alt: plot 02 extract data
   :srcset: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 42-43

The above command creates a new sldata object named ``single_spectrum``. If you just want to plot a a specific trace, this can be done by indexing the sldata object directly:

.. GENERATED FROM PYTHON SOURCE LINES 43-47

.. code-block:: Python


    sl.fancy_plot(data["Power", -1], xlim=[-10, 20])
    sl.plt.show()




.. image-sg:: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_003.png
   :alt: plot 02 extract data
   :srcset: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 48-49

Here, the last spectrum (python index -1) of the sldata object ``data`` is plotted.

.. GENERATED FROM PYTHON SOURCE LINES 51-52

In some situations it is useful to select a subset of spectra from the data set e.g. for further data processing. For example, the first 5 spectra of the sldata object ``data`` can be selected by:

.. GENERATED FROM PYTHON SOURCE LINES 52-55

.. code-block:: Python


    sub_data = data["Power", 0:5]








.. GENERATED FROM PYTHON SOURCE LINES 56-59

Indexing Using Floats
---------------------
In the previous example, a single spectrum or a sub-set of spectra was selected using an integer number to index the data set. This is convenient if this dimension has only a small number of indexes. However, when this dimension is large it is less convenient to use an integer. For example, it is not very convenient to index a 1D NMR spectrum with 8,192 points by an integer indicating the position in the vector/array. Here, it is much more convenient to give the axis value to extract the data that falls within these boundaries.

.. GENERATED FROM PYTHON SOURCE LINES 61-64

.. code-block:: Python


    sub_data = data["f2", (-8.0, 18.0)]








.. GENERATED FROM PYTHON SOURCE LINES 65-66

The spectra are plotted below. Note the range of the data set is -8 to 18 ppm. The new sldata object ``sub_data`` only contains the selected data region, the remaining data points are discarded.

.. GENERATED FROM PYTHON SOURCE LINES 66-74

.. code-block:: Python


    sl.fancy_plot(
        sub_data,
        xlim=[-15, 25],
        title="ODNP, 10 mM TEMPO in Toluene, Slice Spectra Using Floats",
    )
    sl.plt.show()




.. image-sg:: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_004.png
   :alt: ODNP, 10 mM TEMPO in Toluene, Slice Spectra Using Floats
   :srcset: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 75-78

Indexing Multiple Dimensions
----------------------------
For multi-dimensional data sets, the user can specify multiple dimensions at once. For example ``data['x', 1:10, 'y', :, 'z', (3.5, 7.5)]``. In the following example we will select only one single NMR spectrum (e.g. ``'Power' , 0``) within a spectral range of -8 to 18 ppm.

.. GENERATED FROM PYTHON SOURCE LINES 78-83

.. code-block:: Python


    sub_data = data["f2", (-8.0, 18.0), "Power", 0]

    sl.fancy_plot(sub_data)
    sl.plt.show()



.. image-sg:: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_005.png
   :alt: plot 02 extract data
   :srcset: /auto_examples/03_Advanced/images/sphx_glr_plot_02_extract_data_005.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.511 seconds)


.. _sphx_glr_download_auto_examples_03_Advanced_plot_02_extract_data.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_02_extract_data.ipynb <plot_02_extract_data.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_02_extract_data.py <plot_02_extract_data.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_02_extract_data.zip <plot_02_extract_data.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
