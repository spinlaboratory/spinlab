
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\02_Analysis\plot_04_reference_spectra.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_02_Analysis_plot_04_reference_spectra.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_02_Analysis_plot_04_reference_spectra.py:


.. _plot_04_reference_spectra:

==================
Reference  Spectra
==================

This example demonstrates how to reference spectra using Toluene as an example.

.. GENERATED FROM PYTHON SOURCE LINES 12-16

Load Toluene Spectra
-------------------------------
Start with importing data and creating the SpinLab workspace.
The data has been processed and saved in .h5 file.

.. GENERATED FROM PYTHON SOURCE LINES 16-28

.. code-block:: Python


    import numpy as np
    import spinlab as sl

    sampleTag = "10 mM TEMPO in Toluene"
    file_name_path = "../../data/prospa/toluene_10mM_Tempone/42"
    data = sl.load(file_name_path)

    data.attrs["experiment_type"] = "nmr_spectrum"
    data = sl.apodize(data, lw=10)
    data = sl.fourier_transform(data)








.. GENERATED FROM PYTHON SOURCE LINES 29-32

Plot Toluene Spectra
--------------------
Once the data are imported and processed, it is time to plot the 1D spectra.

.. GENERATED FROM PYTHON SOURCE LINES 32-37

.. code-block:: Python


    sl.fancy_plot(data, xlim=[-20, 20], title=sampleTag)
    sl.plt.show()





.. image-sg:: /auto_examples/02_Analysis/images/sphx_glr_plot_04_reference_spectra_001.png
   :alt: 10 mM TEMPO in Toluene
   :srcset: /auto_examples/02_Analysis/images/sphx_glr_plot_04_reference_spectra_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 38-41

Find Toluene Peaks
------------------
In the previous example, we have demonstrated how to find peaks. Now, we apply the SpinLab function *find_peaks* to get a SpinData object of all peaks. 

.. GENERATED FROM PYTHON SOURCE LINES 41-46

.. code-block:: Python



    peaks = sl.find_peaks(data)
    sl.peak_info(peaks)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    C:\Users\thorsten.maly\AppData\Local\Programs\Python\Python311\Lib\site-packages\scipy\signal\_peak_finding.py:266: ComplexWarning: Casting complex values to real discards the imaginary part
      value = np.asarray(value, order='C', dtype=np.float64)
    Peak #1: Index:  8149, Shift (ppm): -1.84, Height : -1365.46, Width (Hz): 18.91, Width Height: 0.29
    Peak #2: Index:  8264, Shift (ppm): 3.09, Height : -2661.71, Width (Hz): 21.76, Width Height: 0.50
    --------------------------------------------




.. GENERATED FROM PYTHON SOURCE LINES 47-51

Reference Proton Peak
---------------------
We can see that chemical shift for proton peak is roughly at 2.79 ppm. 
Let's reference this peak to 7.70 ppm applying the SpinLab function *reference*.

.. GENERATED FROM PYTHON SOURCE LINES 51-58

.. code-block:: Python


    data = sl.reference(data, old_ref = 2.79, new_ref = 7.70)

    # We can plot the spectra after reference.
    sl.fancy_plot(data, xlim=[-10, 30], title=sampleTag)
    sl.plt.show()




.. image-sg:: /auto_examples/02_Analysis/images/sphx_glr_plot_04_reference_spectra_002.png
   :alt: 10 mM TEMPO in Toluene
   :srcset: /auto_examples/02_Analysis/images/sphx_glr_plot_04_reference_spectra_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 59-62

Check the Proton Peak
---------------------
After we referenced the peaks, we can apply *find_peaks* functions again to get a SpinData object of all peaks. 

.. GENERATED FROM PYTHON SOURCE LINES 62-65

.. code-block:: Python


    peaks = sl.find_peaks(data)
    sl.peak_info(peaks)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Peak #1: Index:  8149, Shift (ppm): 3.07, Height : -1365.46, Width (Hz): 18.91, Width Height: 0.29
    Peak #2: Index:  8264, Shift (ppm): 8.00, Height : -2661.71, Width (Hz): 21.76, Width Height: 0.50
    --------------------------------------------





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.164 seconds)


.. _sphx_glr_download_auto_examples_02_Analysis_plot_04_reference_spectra.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_04_reference_spectra.ipynb <plot_04_reference_spectra.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_04_reference_spectra.py <plot_04_reference_spectra.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_04_reference_spectra.zip <plot_04_reference_spectra.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
